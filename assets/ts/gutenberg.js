(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{receiveDegreeProgram:()=>i,receiveDegreePrograms:()=>u});var r={};e.r(r),e.d(r,{getDegreeProgram:()=>le,getDegreePrograms:()=>se});var n={};e.r(n),e.d(n,{getDegreeProgram:()=>fe,getDegreePrograms:()=>pe,hasDegreePrograms:()=>de});const o=window.wp.data;var a="RECEIVE_SINGLE_DEGREE_PROGRAM",c="RECEIVE_DEGREE_PROGRAMS_LIST";function i(e,t){return{type:a,id:e,degreeProgram:t}}function u(e,t){return{type:c,query:e,degreePrograms:t}}var l=Symbol.for("immer-nothing"),s=Symbol.for("immer-draftable"),f=Symbol.for("immer-state");function p(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var d=Object.getPrototypeOf;function g(e){return!!e&&!!e[f]}function m(e){return!!e&&(y(e)||Array.isArray(e)||!!e[s]||!!e.constructor?.[s]||P(e)||S(e))}var _=Object.prototype.constructor.toString();function y(e){if(!e||"object"!=typeof e)return!1;const t=d(e);if(null===t)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===_}function h(e,t){0===v(e)?Reflect.ownKeys(e).forEach((r=>{t(r,e[r],e)})):e.forEach(((r,n)=>t(n,r,e)))}function v(e){const t=e[f];return t?t.type_:Array.isArray(e)?1:P(e)?2:S(e)?3:0}function b(e,t){return 2===v(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function w(e,t,r){const n=v(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function P(e){return e instanceof Map}function S(e){return e instanceof Set}function E(e){return e.copy_||e.base_}function O(e,t){if(P(e))return new Map(e);if(S(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=y(e);if(!0===t||"class_only"===t&&!r){const t=Object.getOwnPropertyDescriptors(e);delete t[f];let r=Reflect.ownKeys(t);for(let n=0;n<r.length;n++){const o=r[n],a=t[o];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(d(e),t)}{const t=d(e);if(null!==t&&r)return{...e};const n=Object.create(t);return Object.assign(n,e)}}function x(e,t=!1){return D(e)||g(e)||!m(e)||(v(e)>1&&(e.set=e.add=e.clear=e.delete=k),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>x(t,!0)))),e}function k(){p(2)}function D(e){return Object.isFrozen(e)}var j,F={};function C(e){const t=F[e];return t||p(0),t}function z(){return j}function A(e,t){t&&(C("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function R(e){M(e),e.drafts_.forEach(U),e.drafts_=null}function M(e){e===j&&(j=e.parent_)}function I(e){return j={drafts_:[],parent_:j,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function U(e){const t=e[f];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function T(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return void 0!==e&&e!==r?(r[f].modified_&&(R(t),p(4)),m(e)&&(e=q(t,e),t.parent_||N(t,e)),t.patches_&&C("Patches").generateReplacementPatches_(r[f].base_,e,t.patches_,t.inversePatches_)):e=q(t,r,[]),R(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==l?e:void 0}function q(e,t,r){if(D(t))return t;const n=t[f];if(!n)return h(t,((o,a)=>B(e,n,t,o,a,r))),t;if(n.scope_!==e)return t;if(!n.modified_)return N(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const t=n.copy_;let o=t,a=!1;3===n.type_&&(o=new Set(t),t.clear(),a=!0),h(o,((o,c)=>B(e,n,t,o,c,r,a))),N(e,t,!1),r&&e.patches_&&C("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function B(e,t,r,n,o,a,c){if(g(o)){const c=q(e,o,a&&t&&3!==t.type_&&!b(t.assigned_,n)?a.concat(n):void 0);if(w(r,n,c),!g(c))return;e.canAutoFreeze_=!1}else c&&r.add(o);if(m(o)&&!D(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;q(e,o),t&&t.scope_.parent_||"symbol"==typeof n||!Object.prototype.propertyIsEnumerable.call(r,n)||N(e,o)}}function N(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&x(t,r)}var L={get(e,t){if(t===f)return e;const r=E(e);if(!b(r,t))return function(e,t,r){const n=V(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}(e,r,t);const n=r[t];return e.finalized_||!m(n)?n:n===K(e.base_,t)?(H(e),e.copy_[t]=J(n,e)):n},has:(e,t)=>t in E(e),ownKeys:e=>Reflect.ownKeys(E(e)),set(e,t,r){const n=V(E(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const n=K(E(e),t),c=n?.[f];if(c&&c.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(((o=r)===(a=n)?0!==o||1/o==1/a:o!=o&&a!=a)&&(void 0!==r||b(e.base_,t)))return!0;H(e),W(e)}var o,a;return e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==K(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,H(e),W(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const r=E(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty(){p(11)},getPrototypeOf:e=>d(e.base_),setPrototypeOf(){p(12)}},G={};function K(e,t){const r=e[f];return(r?E(r):e)[t]}function V(e,t){if(!(t in e))return;let r=d(e);for(;r;){const e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=d(r)}}function W(e){e.modified_||(e.modified_=!0,e.parent_&&W(e.parent_))}function H(e){e.copy_||(e.copy_=O(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function J(e,t){const r=P(e)?C("MapSet").proxyMap_(e,t):S(e)?C("MapSet").proxySet_(e,t):function(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:z(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let o=n,a=L;r&&(o=[n],a=G);const{revoke:c,proxy:i}=Proxy.revocable(o,a);return n.draft_=i,n.revoke_=c,i}(e,t);return(t?t.scope_:z()).drafts_.push(r),r}function X(e){if(!m(e)||D(e))return e;const t=e[f];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=O(e,t.scope_.immer_.useStrictShallowCopy_)}else r=O(e,!0);return h(r,((e,t)=>{w(r,e,X(t))})),t&&(t.finalized_=!1),r}h(L,((e,t)=>{G[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),G.deleteProperty=function(e,t){return G.set.call(this,e,t,void 0)},G.set=function(e,t,r){return L.set.call(this,e[0],t,r,e[0])};var $=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if("function"==typeof e&&"function"!=typeof t){const r=t;t=e;const n=this;return function(e=r,...o){return n.produce(e,(e=>t.call(this,e,...o)))}}let n;if("function"!=typeof t&&p(6),void 0!==r&&"function"!=typeof r&&p(7),m(e)){const o=I(this),a=J(e,void 0);let c=!0;try{n=t(a),c=!1}finally{c?R(o):M(o)}return A(o,r),T(n,o)}if(!e||"object"!=typeof e){if(n=t(e),void 0===n&&(n=e),n===l&&(n=void 0),this.autoFreeze_&&x(n,!0),r){const t=[],o=[];C("Patches").generateReplacementPatches_(e,n,t,o),r(t,o)}return n}p(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...r)=>this.produceWithPatches(t,(t=>e(t,...r)));let r,n;return[this.produce(e,t,((e,t)=>{r=e,n=t})),r,n]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){var t;m(e)||p(8),g(e)&&(g(t=e)||p(10),e=X(t));const r=I(this),n=J(e,void 0);return n[f].isManual_=!0,M(r),n}finishDraft(e,t){const r=e&&e[f];r&&r.isManual_||p(9);const{scope_:n}=r;return A(n,t),T(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));const n=C("Patches").applyPatches_;return g(e)?n(e,t):this.produce(e,(e=>n(e,t)))}},Q=$.produce;$.produceWithPatches.bind($),$.setAutoFreeze.bind($),$.setUseStrictShallowCopy.bind($),$.applyPatches.bind($),$.createDraft.bind($),$.finishDraft.bind($);const Y=Q((function(e,t){switch(t.type){case a:e.degreePrograms[t.id]=t.degreeProgram;break;case c:t.degreePrograms?(e.queries[t.query]=t.degreePrograms.map((function(e){return e.id})),t.degreePrograms.forEach((function(t){e.degreePrograms[t.id]=t}))):e.queries[t.query]=t.degreePrograms}}),{queries:{},degreePrograms:{}});var Z=function(){return Z=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Z.apply(this,arguments)};function ee(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function te(e,t,r,n){return new(r||(r=Promise))((function(o,a){function c(e){try{u(n.next(e))}catch(e){a(e)}}function i(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,i)}u((n=n.apply(e,t||[])).next())}))}function re(e,t){var r,n,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function ne(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)c.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return c}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const oe=window.wp.apiFetch;var ae=e.n(oe);function ce(){if(void 0===window.DegreeProgramBlockServerData)throw new Error("Server data could not be loaded.");return window.DegreeProgramBlockServerData}function ie(e,t){void 0===t&&(t=["lang"]);var r=Object.keys(e).sort().reduce((function(r,n){return t.includes(n)||(r[n]=String(e[n])),r}),{});return new URLSearchParams(r).toString()}function ue(e,t){var r;if(e.lang===t||!e.translations[t])return e;var n=e.translations,o=ee(e,["translations"]),a=n,c=t,i=a[c],u=ee(a,["symbol"==typeof c?c:c+""]);return Z(Z({id:e.id},i),{translations:Z((r={},r[e.lang]=o,r),u)})}function le(e){var t=this;return function(r){var n=r.select,o=r.dispatch;return te(t,void 0,void 0,(function(){var t;return re(this,(function(r){switch(r.label){case 0:if(e<=0)return[2];if(n.getDegreeProgram(e))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ae()({url:"".concat(ce().apiUrl,"/wp-json/fau/v1/degree-program/").concat(e)})];case 2:return t=r.sent(),o.receiveDegreeProgram(e,t),[3,4];case 3:return r.sent(),o.receiveDegreeProgram(e,null),[3,4];case 4:return[2]}}))}))}}function se(e){var t=this;return function(r){var n=r.select,o=r.dispatch;return te(t,void 0,void 0,(function(){var t,r;return re(this,(function(a){switch(a.label){case 0:if(n.hasDegreePrograms(e))return[2];t=ie(e),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,ae()({url:"".concat(ce().apiUrl,"/wp-json/fau/v1/degree-program?").concat(t)})];case 2:return r=a.sent(),o.receiveDegreePrograms(t,r),[3,4];case 3:return a.sent(),o.receiveDegreePrograms(t,null),[3,4];case 4:return[2]}}))}))}}function fe(e,t,r){var n=e.degreePrograms[t];return n?ue(n,r):n}function pe(e,t){var r=e.queries[ie(t)];return r?r.reduce((function(r,n){var o,a=e.degreePrograms[n];return a&&r.push(ue(a,null!==(o=t.lang)&&void 0!==o?o:"de")),r}),[]):r}function de(e,t){return void 0!==e.queries[ie(t)]}var ge=(0,o.createReduxStore)("degree-program",{reducer:Y,actions:t,selectors:n,resolvers:r});(0,o.register)(ge);const me=window.wp.blocks,_e=JSON.parse('{"UU":"fau/degree-program"}'),ye=window.wp.blockEditor,he=window.wp.components,ve=window.wp.i18n;var be={},we={};Object.entries(ce().supportedProperties).forEach((function(e){var t=ne(e,2),r=t[0],n=t[1];be[r]=n,we[n]=r}));var Pe=Object.values(be).sort();function Se(e){var t=e.label,r=e.value,n=e.onChange;return wp.element.createElement(he.BaseControl,null,wp.element.createElement("div",{tabIndex:-1,role:"listbox"},wp.element.createElement(he.FormTokenField,{label:t,value:r.map((function(e){return be[e]})),suggestions:Pe,onChange:function(e){return n(e.map((function(e){return we[e]})))},__experimentalShowHowTo:!1,__experimentalValidateInput:function(e){return!!we[e]},__experimentalExpandOnFocus:!0})))}const Ee=window.React,Oe=window.lodash,xe=window.wp.compose;var ke=function(e){return"".concat(e.title," (").concat(e.degree.abbreviation,")")};function De(e){var t=e.value,r=e.lang,n=void 0===r?"de":r,a=e.onChange,c=ne((0,Ee.useState)(""),2),i=c[0],u=c[1],l=ne((0,Ee.useState)(""),2),s=l[0],f=l[1],p=(0,xe.useDebounce)(f,500),d=(0,o.useSelect)((function(e){return e(ge.name).getDegreeProgram(t,n)}),[t,n]),g=(0,o.useSelect)((function(e){return e(ge.name).getDegreePrograms({search:s,lang:n,per_page:20})}),[s,n]),m=(0,Ee.useCallback)((function(e){var t=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}([],ne(null!=g?g:[]),!1);return d&&t.push(d),(0,Oe.find)(t,(function(t){return ke(t)===e}))}),[d,g]);(0,Ee.useEffect)((function(){d&&u(ke(d))}),[d]);var _=(0,Ee.useMemo)((function(){return d||!g?[]:g.map(ke)}),[g,d]);return wp.element.createElement(he.BaseControl,null,wp.element.createElement("div",{tabIndex:-1,role:"listbox"},wp.element.createElement(he.FormTokenField,{label:(0,ve._x)("Select degree program","backoffice: block editor","fau-degree-program-output"),maxLength:1,value:i?[i]:[],suggestions:_,onChange:function(e){var t,r,n=null!==(t=e[0])&&void 0!==t?t:"",o=m(e[0]);u(n),a(null!==(r=null==o?void 0:o.id)&&void 0!==r?r:0),f("")},onInputChange:p,maxSuggestions:20,__experimentalShowHowTo:!1,__experimentalValidateInput:function(e){return!!m(e)},__experimentalExpandOnFocus:!0}),null===g&&wp.element.createElement("p",null,(0,ve._x)("Could not load suggestion list","backend: block editor","fau-degree-program-output"))))}const je=function(e){var t,r,n,o,a,c=e.attributes,i=e.setAttributes;return wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(De,{value:null!==(t=c.id)&&void 0!==t?t:0,lang:c.lang,onChange:function(e){return i({id:e})}}),wp.element.createElement(he.Flex,null,wp.element.createElement(he.FlexBlock,null,wp.element.createElement(he.SelectControl,{label:(0,ve._x)("Language","backoffice: block editor","fau-degree-program-common"),options:[{label:"Deutsch",value:"de"},{label:"English",value:"en"}],value:c.lang,onChange:function(e){return i({lang:e})}})),wp.element.createElement(he.FlexBlock,null,wp.element.createElement(he.SelectControl,{label:(0,ve._x)("Format","backoffice: block editor","fau-degree-program-common"),options:[{label:"Short",value:"short"},{label:"Full",value:"full"}],value:c.format,onChange:function(e){return i({format:e})}}))),"full"===c.format&&!(null===(r=c.exclude)||void 0===r?void 0:r.length)&&wp.element.createElement(Se,{label:(0,ve._x)("Include","backoffice: block editor","fau-degree-program-common"),value:null!==(n=c.include)&&void 0!==n?n:[],onChange:function(e){return i({include:e})}}),"full"===c.format&&!(null===(o=c.include)||void 0===o?void 0:o.length)&&wp.element.createElement(Se,{label:(0,ve._x)("Exclude","backoffice: block editor","fau-degree-program-common"),value:null!==(a=c.exclude)&&void 0!==a?a:[],onChange:function(e){return i({exclude:e})}}))};var Fe=_e.UU;(0,me.registerBlockType)(Fe,{edit:function(e){var t=(0,ye.useBlockProps)();return wp.element.createElement("div",Z({},t),wp.element.createElement(je,Z({},e)))},save:function(){return null}})})();